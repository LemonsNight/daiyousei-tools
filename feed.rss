<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>S u z u k a</title>
        <link>https://blog.vuejs.org</link>
        <description>A VitePress site</description>
        <lastBuildDate>Fri, 17 May 2024 07:37:04 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-CN</language>
        <image>
            <title>S u z u k a</title>
            <url>https://vuejs.org/images/logo.png</url>
            <link>https://blog.vuejs.org</link>
        </image>
        <copyright>flaribbit</copyright>
        <item>
            <title><![CDATA[测试文档]]></title>
            <link>https://blog.vuejs.orgposts/doc2.html</link>
            <guid>https://blog.vuejs.orgposts/doc2.html</guid>
            <content:encoded><![CDATA[<a href="#" class="totop" style="top:-900px;" aria-label="to-top"></a><!--[--><div class="abanner" style="background-image: url(/vitepress-theme-sakura/60651947_p0.jpg)"><div class="titlebox"><h1 class="title">测试文档</h1><div class="info">flaribbit · 更新于 2024-05-17 · 0 次阅读</div></div></div><div class="article"><div style="position:relative;" class="content"><div><h2 id="代码测试" tabindex="-1">代码测试 <a class="header-anchor" href="#代码测试" aria-label="Permalink to &quot;代码测试&quot;">​</a></h2><p>二分查找 <code>binsearch</code></p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-light vp-code"><code><span class="line"><span style="color:#6A737D;">//[l, r)</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#6F42C1;"> search</span><span style="color:#24292E;">(</span><span style="color:#E36209;">nums</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;"> number</span><span style="color:#24292E;">[], </span><span style="color:#E36209;">target</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;"> number</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#005CC5;"> number</span><span style="color:#24292E;"> { </span></span>
<span class="line"><span style="color:#D73A49;">    let</span><span style="color:#24292E;"> l </span><span style="color:#D73A49;">=</span><span style="color:#005CC5;"> 0</span><span style="color:#24292E;">, r </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> nums.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">    while</span><span style="color:#24292E;"> (l </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> r) {</span></span>
<span class="line"><span style="color:#D73A49;">        let</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (l </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> r) </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#005CC5;"> 1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">        if</span><span style="color:#24292E;"> (nums[c] </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> target) {</span></span>
<span class="line"><span style="color:#24292E;">            r </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> c;</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#D73A49;"> if</span><span style="color:#24292E;"> (nums[c] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> target) {</span></span>
<span class="line"><span style="color:#24292E;">            l </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> c </span><span style="color:#D73A49;">+</span><span style="color:#005CC5;"> 1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#D73A49;">            return</span><span style="color:#24292E;"> c;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#D73A49;">    return</span><span style="color:#D73A49;"> -</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_2-级标题" tabindex="-1">2 级标题 <a class="header-anchor" href="#_2-级标题" aria-label="Permalink to &quot;2 级标题&quot;">​</a></h2><h3 id="_3-级标题" tabindex="-1">3 级标题 <a class="header-anchor" href="#_3-级标题" aria-label="Permalink to &quot;3 级标题&quot;">​</a></h3><h4 id="_4-级标题" tabindex="-1">4 级标题 <a class="header-anchor" href="#_4-级标题" aria-label="Permalink to &quot;4 级标题&quot;">​</a></h4><p>有序列表</p><ol><li>First item</li><li>Second item</li><li>Third item</li><li>Fourth item</li></ol><p>无序列表</p><ul><li>First item</li><li>Second item</li><li>Third item</li><li>Fourth item</li></ul><h2 id="katex-测试" tabindex="-1">katex 测试 <a class="header-anchor" href="#katex-测试" aria-label="Permalink to &quot;katex 测试&quot;">​</a></h2><p>正态分布的概率密度函数均值为 $\mu$ 方差为 $\sigma^2$ (或标准差 $\sigma$ )，是高斯函数的一个实例：</p> $$f(x;\mu,\sigma)=\frac{1}{\sigma\sqrt{2\pi}} \exp \left( -\frac{(x- \mu)^2}{2\sigma^2} \right)$$ <p>如果一个随机变量 $X$ 服从这个分布，我们写作 $X \sim N(\mu, \sigma^2)$ 。如果 $\mu =0$ 并且 $\sigma =1$ ，这个分布被称为标准正态分布，这个分布能够简化为</p> $$f(x) = \frac{1}{\sqrt{2\pi}} \exp\left(-\frac{x^2}{2} \right)$$ <p>累积分布函数是指随机变量 $X$ 小于或等于 $x$ 的概率，用概率密度函数表示为</p> $$F(x;\mu,\sigma)=\frac{1}{\sigma\sqrt{2\pi}}\int_{-\infty}^x \exp \left( -\frac{(t - \mu)^2}{2\sigma^2}\ \right) dt$$ <p>正态分布的累积分布函数能够由一个叫做误差函数的特殊函数表示：</p> $$\Phi (z)={\frac 12}\left[1+\operatorname {erf}\left({\frac {z-\mu }{\sigma {\sqrt 2}}}\right)\right]$$ </div></div><div class="content nav"><span><!----></span><span><a href="./posts/ast埋点.html">使用ast实现uniapp埋点 <i class="fa fa-angle-right"></i></a></span></div><div id="waline"></div><div class="toc"><ol><!--[--><!--]--></ol></div></div><!--]-->]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[使用ast实现uniapp埋点]]></title>
            <link>https://blog.vuejs.orgposts/ast埋点.html</link>
            <guid>https://blog.vuejs.orgposts/ast埋点.html</guid>
            <content:encoded><![CDATA[<a href="#" class="totop" style="top:-900px;" aria-label="to-top"></a><!--[--><!----><div class="article"><div style="position:relative;" class="content"><div><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>最近接到埋点需求，需要对Uni项目的App端和小程序进行埋点。经过研究社区提供的方案后，发现并没有一个完全符合公司业务需求的方案。因此，决定自己动手实现一个定制化的埋点方案。</p><h2 id="方案以及实现原理" tabindex="-1">方案以及实现原理 <a class="header-anchor" href="#方案以及实现原理" aria-label="Permalink to &quot;方案以及实现原理&quot;">​</a></h2><p>前提条件是使用Vite脚手架搭建的Uni项目。</p><p>解决方案是编写一个Vite插件，在构建过程中预先修改模板字符串。借助Vue自带的vue/compiler-sfc插件，我们可以将Vue代码解析为AST（抽象语法树），通过AST精确修改模板代码，无需使用复杂的正则表达式进行字符串匹配和修改。这种方案适用于大多数Vue项目。需要注意的是，由于这种操作会修改项目代码，建议在完成后编写测试进行验证，推荐使用Vitest进行测试。</p><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-label="Permalink to &quot;&quot;">​</a></h2><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-light vp-code"><code><span class="line"><span style="color:#24292E;">由于小程序端以及app端并没有window，所以需要使用混入的方式</span></span>
<span class="line"><span style="color:#24292E;">// utils.ts</span></span>
<span class="line"><span style="color:#24292E;">export const 你的埋点函数 = {</span></span>
<span class="line"><span style="color:#24292E;">  methods: {</span></span>
<span class="line"><span style="color:#24292E;">    sendMd: (code: string) =&gt; {</span></span>
<span class="line"><span style="color:#24292E;">    // ... 处理你的业务</span></span>
<span class="line"><span style="color:#24292E;">      uni.$emit(&quot;sendMd&quot;, code);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">APP.VUE</span></span>
<span class="line"><span style="color:#24292E;">export const createApp = () =&gt; {</span></span>
<span class="line"><span style="color:#24292E;">   // ***</span></span>
<span class="line"><span style="color:#24292E;">  app.mixin(&#39;你的埋点函数&#39;);</span></span>
<span class="line"><span style="color:#24292E;">  return { app, Pinia };</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>pages.vue</p><div class="language-vue line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki github-light vp-code"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#B31D28;font-style:italic;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#B31D28;font-style:italic;">view</span><span style="color:#24292E;"> @</span><span style="color:#6F42C1;">click</span><span style="color:#24292E;">=test </span><span style="color:#6F42C1;">data-md</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;code1&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">                // ....</span></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#B31D28;font-style:italic;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#B31D28;font-style:italic;">view</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">template</span><span style="color:#24292E;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>inject-click-handler.ts vite插件</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-light vp-code"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { parse } </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &quot;vue/compiler-sfc&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { Plugin } </span><span style="color:#D73A49;">from</span><span style="color:#032F62;"> &quot;vite&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#D73A49;"> default</span><span style="color:#24292E;"> ()</span><span style="color:#D73A49;">:</span><span style="color:#6F42C1;"> Plugin</span><span style="color:#D73A49;"> =&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#D73A49;">  return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    name: </span><span style="color:#032F62;">&quot;inject-click-handler&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#6F42C1;">    transform</span><span style="color:#24292E;">(</span><span style="color:#E36209;">code</span><span style="color:#24292E;">, </span><span style="color:#E36209;">id</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#D73A49;">      try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#D73A49;">        if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#032F62;">/</span><span style="color:#005CC5;">.</span><span style="color:#032F62;">vue</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">/</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(id)) </span><span style="color:#D73A49;">return</span><span style="color:#005CC5;"> null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">        const</span><span style="color:#005CC5;"> parseCode</span><span style="color:#D73A49;"> =</span><span style="color:#6F42C1;"> parse</span><span style="color:#24292E;">(code);</span></span>
<span class="line"><span style="color:#D73A49;">        if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">parseCode) </span><span style="color:#D73A49;">return</span><span style="color:#005CC5;"> null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">        if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">parseCode.descriptor?.template?.content) </span><span style="color:#D73A49;">return</span><span style="color:#005CC5;"> null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">        const</span><span style="color:#005CC5;"> dataMdRegex</span><span style="color:#D73A49;"> =</span><span style="color:#032F62;"> /&lt;</span><span style="color:#005CC5;">[</span><span style="color:#D73A49;">^</span><span style="color:#005CC5;">&gt;]</span><span style="color:#D73A49;">*\b</span><span style="color:#032F62;">data-md=&quot;(</span><span style="color:#005CC5;">[</span><span style="color:#D73A49;">^</span><span style="color:#005CC5;">&quot;]</span><span style="color:#D73A49;">*</span><span style="color:#032F62;">)&quot;</span><span style="color:#005CC5;">[</span><span style="color:#D73A49;">^</span><span style="color:#005CC5;">&gt;]</span><span style="color:#D73A49;">*</span><span style="color:#032F62;">&gt;/</span><span style="color:#D73A49;">g</span><span style="color:#24292E;">; </span><span style="color:#6A737D;">// 匹配data-md，这里需要根据业务进行调整。</span></span>
<span class="line"><span style="color:#6A737D;">        // 匹配当前文件是否有埋点标识，在继续往下遍历ast</span></span>
<span class="line"><span style="color:#D73A49;">        const</span><span style="color:#24292E;"> { </span><span style="color:#005CC5;">content</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">ast</span><span style="color:#24292E;"> } </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parseCode.descriptor.template;</span></span>
<span class="line"><span style="color:#6A737D;">        // 返回null的时候表示不修改任何代码</span></span>
<span class="line"><span style="color:#D73A49;">        if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">content.</span><span style="color:#6F42C1;">match</span><span style="color:#24292E;">(dataMdRegex)) {</span></span>
<span class="line"><span style="color:#D73A49;">          return</span><span style="color:#005CC5;"> null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#6A737D;">        // 获取template模板</span></span>
<span class="line"><span style="color:#D73A49;">        let</span><span style="color:#24292E;"> $code </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> parseCode.descriptor.template.content;</span></span>
<span class="line"><span style="color:#6A737D;">        // 需要修改的节点数组</span></span>
<span class="line"><span style="color:#D73A49;">        const</span><span style="color:#005CC5;"> nodeArray</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> [];</span></span>
<span class="line"><span style="color:#6A737D;">        // 递归ast节点</span></span>
<span class="line"><span style="color:#D73A49;">        const</span><span style="color:#6F42C1;"> handleEachAst</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> (</span><span style="color:#E36209;">node</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#D73A49;">          if</span><span style="color:#24292E;"> (node?.props.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#6A737D;">             // 查找我们在页面写的data-md</span></span>
<span class="line"><span style="color:#D73A49;">            const</span><span style="color:#005CC5;"> isMd</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> node?.props?.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">              (</span><span style="color:#E36209;">item</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span></span>
<span class="line"><span style="color:#24292E;">                item?.name </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &quot;data-md&quot;</span><span style="color:#D73A49;"> ||</span></span>
<span class="line"><span style="color:#24292E;">                (item.name </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &quot;bind&quot;</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#24292E;"> item?.arg?.content </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &quot;data-md&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            );</span></span>
<span class="line"><span style="color:#6A737D;">            // 查找当前元素是否有点击函数并追加混入的埋点函数</span></span>
<span class="line"><span style="color:#D73A49;">            if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!!</span><span style="color:#24292E;">isMd) {</span></span>
<span class="line"><span style="color:#D73A49;">              const</span><span style="color:#005CC5;"> findVueClickEvent</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> node?.props?.</span><span style="color:#6F42C1;">find</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">                (</span><span style="color:#E36209;">item</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> item.name </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &quot;on&quot;</span><span style="color:#D73A49;"> &amp;&amp;</span><span style="color:#24292E;"> item.type </span><span style="color:#D73A49;">===</span><span style="color:#005CC5;"> 7</span></span>
<span class="line"><span style="color:#24292E;">              );</span></span>
<span class="line"><span style="color:#D73A49;">              let</span><span style="color:#24292E;"> pushFn </span><span style="color:#D73A49;">=</span><span style="color:#032F62;"> &quot;&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">              const</span><span style="color:#005CC5;"> mdContent</span><span style="color:#D73A49;"> =</span></span>
<span class="line"><span style="color:#24292E;">                isMd.name </span><span style="color:#D73A49;">===</span><span style="color:#032F62;"> &quot;data-md&quot;</span><span style="color:#D73A49;"> ?</span><span style="color:#032F62;"> `&#39;${</span><span style="color:#24292E;">isMd</span><span style="color:#032F62;">.</span><span style="color:#24292E;">value</span><span style="color:#032F62;">.</span><span style="color:#24292E;">content</span><span style="color:#032F62;">}&#39;`</span><span style="color:#D73A49;"> :</span><span style="color:#24292E;"> isMd.exp.content;</span></span>
<span class="line"><span style="color:#D73A49;">              if</span><span style="color:#24292E;"> (findVueClickEvent) {</span></span>
<span class="line"><span style="color:#6A737D;">                 // 检查是否一个函数   sendMd是混入的埋点函数</span></span>
<span class="line"><span style="color:#D73A49;">                const</span><span style="color:#005CC5;"> isFunctionCall</span><span style="color:#D73A49;"> =</span><span style="color:#032F62;"> /</span><span style="color:#D73A49;">^</span><span style="color:#005CC5;">\s</span><span style="color:#D73A49;">*</span><span style="color:#005CC5;">[a-zA-Z_$][0-9a-zA-Z_$]</span><span style="color:#D73A49;">*</span><span style="color:#005CC5;">\s</span><span style="color:#D73A49;">*</span><span style="color:#032F62;">(</span><span style="color:#005CC5;">[</span><span style="color:#D73A49;">^</span><span style="color:#005CC5;">)]</span><span style="color:#D73A49;">*</span><span style="color:#032F62;">)</span><span style="color:#005CC5;">\s</span><span style="color:#D73A49;">*$</span><span style="color:#032F62;">/</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">                if</span><span style="color:#24292E;"> (</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">isFunctionCall.</span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">(findVueClickEvent.exp.content)) {</span></span>
<span class="line"><span style="color:#24292E;">                  findVueClickEvent.exp.content </span><span style="color:#D73A49;">+=</span><span style="color:#032F62;"> &quot;()&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">                }</span></span>
<span class="line"><span style="color:#24292E;">                pushFn </span><span style="color:#D73A49;">=</span><span style="color:#032F62;"> `@${</span><span style="color:#24292E;">findVueClickEvent</span><span style="color:#032F62;">.</span><span style="color:#24292E;">arg</span><span style="color:#032F62;">.</span><span style="color:#24292E;">content</span><span style="color:#032F62;">}=&quot;sendMd(&#39;sendMd&#39;,${</span><span style="color:#24292E;">mdContent</span><span style="color:#032F62;">});${</span><span style="color:#24292E;">findVueClickEvent</span><span style="color:#032F62;">.</span><span style="color:#24292E;">exp</span><span style="color:#032F62;">.</span><span style="color:#24292E;">content</span><span style="color:#032F62;">}&quot;`</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">              } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">                pushFn </span><span style="color:#D73A49;">=</span><span style="color:#032F62;"> `@click=&quot;sendMd(&#39;sendMd&#39;,${</span><span style="color:#24292E;">mdContent</span><span style="color:#032F62;">})&quot;`</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">              }</span></span>
<span class="line"><span style="color:#D73A49;">              const</span><span style="color:#005CC5;"> nodeStr</span><span style="color:#D73A49;"> =</span><span style="color:#24292E;"> node.loc.source.</span><span style="color:#6F42C1;">replace</span><span style="color:#24292E;">(findVueClickEvent.loc.source, pushFn);</span></span>
<span class="line"><span style="color:#24292E;">              nodeArray.</span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">({</span></span>
<span class="line"><span style="color:#24292E;">                source: node.loc.source,</span></span>
<span class="line"><span style="color:#24292E;">                replaceSource: nodeStr</span></span>
<span class="line"><span style="color:#24292E;">              });</span></span>
<span class="line"><span style="color:#24292E;">            }</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#D73A49;">          if</span><span style="color:#24292E;"> (Array.</span><span style="color:#6F42C1;">isArray</span><span style="color:#24292E;">(node?.children)) {</span></span>
<span class="line"><span style="color:#24292E;">            node.children.</span><span style="color:#6F42C1;">forEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">item</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">              item.props </span><span style="color:#D73A49;">&amp;&amp;</span><span style="color:#6F42C1;"> handleEachAst</span><span style="color:#24292E;">(item);</span></span>
<span class="line"><span style="color:#24292E;">            });</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">          if</span><span style="color:#24292E;"> (nodeArray.</span><span style="color:#005CC5;">length</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            nodeArray.</span><span style="color:#6F42C1;">forEach</span><span style="color:#24292E;">((</span><span style="color:#E36209;">item</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">=&gt;</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">              $code </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $code.</span><span style="color:#6F42C1;">replace</span><span style="color:#24292E;">(item.source, item.replaceSource);</span></span>
<span class="line"><span style="color:#24292E;">            });</span></span>
<span class="line"><span style="color:#24292E;">          }</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">        handleEachAst</span><span style="color:#24292E;">(ast);</span></span>
<span class="line"><span style="color:#D73A49;">        return</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">          code: code.</span><span style="color:#6F42C1;">replace</span><span style="color:#24292E;">(parseCode.descriptor.template.content, $code)</span></span>
<span class="line"><span style="color:#24292E;">        };</span></span>
<span class="line"><span style="color:#24292E;">      } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (e) {</span></span>
<span class="line"><span style="color:#D73A49;">        return</span><span style="color:#005CC5;"> null</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">      }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">  };</span></span>
<span class="line"><span style="color:#24292E;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br></div></div><p>vite.config.js</p><div class="language-ts line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki github-light vp-code"><code><span class="line"></span>
<span class="line"><span style="color:#6F42C1;">plugins</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#6F42C1;">  InjectClickHandler</span><span style="color:#24292E;">(), </span><span style="color:#6A737D;">// 必须写在uniPlugin前面</span></span>
<span class="line"><span style="color:#24292E;">  uniPlugin,</span></span>
<span class="line"><span style="color:#6A737D;">  // ...</span></span>
<span class="line"><span style="color:#24292E;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div><div class="content nav"><span><a href=""><i class="fa fa-angle-left"></i> </a></span><span><a href=""> <i class="fa fa-angle-right"></i></a></span></div><!----><div class="toc"><ol><!--[--><!--]--></ol></div></div><!--]-->]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[本页面的 github 仓库链接]]></title>
            <link>https://blog.vuejs.orgposts/comming-soon.html</link>
            <guid>https://blog.vuejs.orgposts/comming-soon.html</guid>
            <pubDate>Fri, 11 Feb 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><a href="https://github.com/flaribbit/vitepress-theme-sakura" target="_blank" rel="noreferrer">点击这里</a></p>
<p>还在摸鱼中，当前预览不代表最终效果</p>
]]></description>
            <content:encoded><![CDATA[<a href="#" class="totop" style="top:-900px;" aria-label="to-top"></a><!--[--><div class="abanner" style="background-image: url(60651947_p0.jpg)"><div class="titlebox"><h1 class="title">本页面的 github 仓库链接</h1><div class="info">flaribbit · 更新于 2022-02-11 · 0 次阅读</div></div></div><div class="article"><div style="position:relative;" class="content"><div><p><a href="https://github.com/flaribbit/vitepress-theme-sakura" target="_blank" rel="noreferrer">点击这里</a></p><p>还在摸鱼中，当前预览不代表最终效果</p><hr><p>啊你居然点进来，可惜没有更多内容了</p></div></div><div class="content nav"><span><a href="./posts/ast埋点.html"><i class="fa fa-angle-left"></i> 使用ast实现uniapp埋点</a></span><span><a href="./posts/doc1.html">What is VitePress? <i class="fa fa-angle-right"></i></a></span></div><div id="waline"></div><div class="toc"><ol><!--[--><!--]--></ol></div></div><!--]-->]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[What is VitePress?]]></title>
            <link>https://blog.vuejs.orgposts/doc1.html</link>
            <guid>https://blog.vuejs.orgposts/doc1.html</guid>
            <pubDate>Sat, 01 Jan 2022 00:00:00 GMT</pubDate>
            <description><![CDATA[<p>VitePress is <a href="https://vuepress.vuejs.org/" target="_blank" rel="noreferrer">VuePress</a>' little brother, built on top of <a href="https://github.com/vitejs/vite" target="_blank" rel="noreferrer">Vite</a>.</p>
]]></description>
            <content:encoded><![CDATA[<a href="#" class="totop" style="top:-900px;" aria-label="to-top"></a><!--[--><div class="abanner" style="background-image: url(60651947_p0.jpg)"><div class="titlebox"><h1 class="title">What is VitePress?</h1><div class="info">flaribbit · 更新于 2022-01-01 · 0 次阅读</div></div></div><div class="article"><div style="position:relative;" class="content"><div><p>VitePress is <a href="https://vuepress.vuejs.org/" target="_blank" rel="noreferrer">VuePress</a>&#39; little brother, built on top of <a href="https://github.com/vitejs/vite" target="_blank" rel="noreferrer">Vite</a>.</p><hr><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>VitePress is currently in 0.x status. It is already suitable for out-of-the-box documentation use, but the config and theming API may still change between minor releases.</p></div><h2 id="motivation" tabindex="-1">Motivation <a class="header-anchor" href="#motivation" aria-label="Permalink to &quot;Motivation&quot;">​</a></h2><p>We love VuePress v1, but being built on top of Webpack, the time it takes to spin up the dev server for a simple doc site with a few pages is just becoming unbearable. Even HMR updates can take up to seconds to reflect in the browser!</p><p>Fundamentally, this is because VuePress v1 is a Webpack app under the hood. Even with just two pages, it&#39;s a full on Webpack project (including all the theme source files) being compiled. It gets even worse when the project has many pages – every page must first be fully compiled before the server can even display anything!</p><p>Incidentally, Vite solves these problems really well: nearly instant server start, an on-demand compilation that only compiles the page being served, and lightning-fast HMR. Plus, there are a few additional design issues I have noted in VuePress v1 over time but never had the time to fix due to the amount of refactoring it would require.</p><p>Now, with Vite and Vue 3, it is time to rethink what a &quot;Vue-powered static site generator&quot; can really be.</p><h2 id="improvements-over-vuepress-v1" tabindex="-1">Improvements Over VuePress v1 <a class="header-anchor" href="#improvements-over-vuepress-v1" aria-label="Permalink to &quot;Improvements Over VuePress v1&quot;">​</a></h2><p>There&#39;re couple of things that are improved from VuePress v1....</p><h3 id="it-uses-vue-3" tabindex="-1">It Uses Vue 3 <a class="header-anchor" href="#it-uses-vue-3" aria-label="Permalink to &quot;It Uses Vue 3&quot;">​</a></h3><p>Leverages Vue 3&#39;s improved template static analysis to stringify static content as much as possible. Static content is sent as string literals instead of JavaScript render function code – the JS payload is therefore <em>much</em> cheaper to parse, and hydration also becomes faster.</p><p>Note the optimization is applied while still allowing the user to freely mix Vue components inside markdown content – the compiler does the static/dynamic separation for you automatically and you never need to think about it.</p><h3 id="it-uses-vite-under-the-hood" tabindex="-1">It Uses Vite Under The Hood <a class="header-anchor" href="#it-uses-vite-under-the-hood" aria-label="Permalink to &quot;It Uses Vite Under The Hood&quot;">​</a></h3><ul><li>Faster dev server start</li><li>Faster hot updates</li><li>Faster build (uses Rollup internally)</li></ul><h3 id="lighter-page-weight" tabindex="-1">Lighter Page Weight <a class="header-anchor" href="#lighter-page-weight" aria-label="Permalink to &quot;Lighter Page Weight&quot;">​</a></h3><ul><li>Vue 3 tree-shaking + Rollup code splitting</li><li>Does not ship metadata for every page on every request. This decouples page weight from total number of pages. Only the current page&#39;s metadata is sent. Client side navigation fetches the new page&#39;s component and metadata together.</li><li>Does not use <code>vue-router</code> because the need of VitePress is very simple and specific - a simple custom router (under 200 LOC) is used instead.</li><li>(WIP) i18n locale data should also be fetched on demand.</li></ul><h2 id="other-differences" tabindex="-1">Other Differences <a class="header-anchor" href="#other-differences" aria-label="Permalink to &quot;Other Differences&quot;">​</a></h2><p>VitePress is more opinionated and less configurable: VitePress aims to scale back the complexity in the current VuePress and restart from its minimalist roots.</p><p>VitePress is future oriented: VitePress only targets browsers that support native ES module imports. It encourages the use of native JavaScript without transpilation, and CSS variables for theming.</p><h2 id="will-this-become-the-next-vuepress-in-the-future" tabindex="-1">Will This Become The Next VuePress in The Future? <a class="header-anchor" href="#will-this-become-the-next-vuepress-in-the-future" aria-label="Permalink to &quot;Will This Become The Next VuePress in The Future?&quot;">​</a></h2><p>We already have <a href="https://github.com/vuepress/vuepress-next" target="_blank" rel="noreferrer">vuepress-next</a>, which would be the next major version of VuePress. It also makes lots of improvements over VuePress v1, and also supports Vite now.</p><p>VitePress is not compatible with the current VuePress ecosystem (mostly themes and plugins). The overall idea is that VitePress will have a drastically more minimal theming API (preferring JavaScript APIs instead of file layout conventions) and likely no plugins (all customization is done in themes).</p></div></div><div class="content nav"><span><a href="./posts/comming-soon.html"><i class="fa fa-angle-left"></i> 本页面的 github 仓库链接</a></span><span><!----></span></div><div id="waline"></div><div class="toc"><ol><!--[--><!--]--></ol></div></div><!--]-->]]></content:encoded>
        </item>
    </channel>
</rss>